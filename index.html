<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Field Service</title>

  <!-- Fluent UI Web Components -->
  <script type="module" src="https://unpkg.com/@fluentui/web-components@2.6.1"></script>

  <style>
    :root{
      --bg: #f5f6f8;
      --panel: #ffffff;
      --border: #e1e3e6;
      --text: #1b1a19;
      --muted: #605e5c;
      --shadow: 0 1px 2px rgba(0,0,0,.06), 0 6px 24px rgba(0,0,0,.06);
      --radius: 12px;
      --topbar-h: 48px;
      --nav-w: 260px;
      --accent: #106ebe;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body{
      margin:0;
      font-family: Segoe UI, -apple-system, BlinkMacSystemFont, "Helvetica Neue", Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    .shell{
      height:100vh;
      display:grid;
      grid-template-rows: var(--topbar-h) 1fr;
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding: 0 14px;
      background: var(--panel);
      border-bottom:1px solid var(--border);
    }
    .brand .title{ font-weight: 600; }

    .main{
      min-height:0;
      display:grid;
      grid-template-columns: var(--nav-w) 1fr;
    }

    .sidebar{
      background: var(--panel);
      border-right:1px solid var(--border);
      padding: 12px;
      display:flex;
      flex-direction:column;
      gap:10px;
      min-height:0;
    }
    .nav-title{ font-weight: 600; }
    .nav-section{
      margin-top: 6px;
      padding-top: 10px;
      border-top:1px solid var(--border);
    }
    .nav-section small{ color: var(--muted); display:block; margin: 0 6px 8px; }
    .nav-btn{ width:100%; display:flex; justify-content:flex-start; }

    .content{
      padding: 16px;
      min-height:0;
      overflow:auto;
    }
    .card{
      background: var(--panel);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px;
      min-height: calc(100vh - var(--topbar-h) - 32px);
    }

    .row{ display:flex; gap:10px; align-items:center; }
    .row.wrap{ flex-wrap:wrap; }
    .space{ flex:1; }
    .muted{ color: var(--muted); }
    .h1{ font-size: 18px; font-weight: 650; margin:0; }
    .h2{ font-size: 14px; font-weight: 650; margin:0; }
    .divider{ height:1px; background: var(--border); margin: 12px 0; }

    .notice{
      border:1px solid var(--border);
      background:#fff;
      border-radius: 10px;
      padding:10px;
      margin: 10px 0;
    }
    .notice.ok{ border-color:#c7e0c2; background:#f3fff2; }
    .notice.err{ border-color:#f2b8b5; background:#fff6f5; }
    .notice.warn{ border-color:#f6d27a; background:#fffbf0; }

    .grid-2{
      display:grid;
      grid-template-columns: 1.05fr 0.95fr;
      gap: 12px;
      min-height:0;
    }
    @media (max-width: 1100px){
      .main{ grid-template-columns: 1fr; }
      .sidebar{ display:none; }
      .grid-2{ grid-template-columns: 1fr; }
    }

    .panel{
      border:1px solid var(--border);
      border-radius: var(--radius);
      background: var(--panel);
      padding: 12px;
      min-height:0;
    }

    /* Items */
    .items{ display:flex; flex-direction:column; gap:10px; margin-top: 10px; }
    .item-row{
      border:1px solid var(--border);
      border-radius: 12px;
      padding: 10px;
      background:#fff;
      display:grid;
      grid-template-columns: 1.6fr 0.7fr 1.0fr;
      gap:10px;
      align-items:start;
    }
    .item-meta{ display:flex; flex-direction:column; gap:4px; }
    .tag{
      display:inline-flex;
      align-items:center;
      gap:6px;
      font-size: 12px;
      padding: 2px 8px;
      border-radius: 999px;
      border:1px solid var(--border);
      color: var(--muted);
      width: fit-content;
    }
    .tag.wo{ border-color: rgba(16,110,190,.35); color: var(--accent); }
    .tag.vs{ border-color: rgba(138,90,0,.35); color: #8a5a00; }

    .status-badge{
      display:inline-flex;
      font-size: 12px;
      padding: 2px 8px;
      border-radius: 999px;
      border:1px solid var(--border);
      color: var(--muted);
      width: fit-content;
    }
    .status-badge.recv{ background:#f3fff2; border-color:#c7e0c2; color:#1a5e1a; }
    .status-badge.miss{ background:#fff6f5; border-color:#f2b8b5; color:#a4262c; }
    .status-badge.dmg{ background:#fffbf0; border-color:#f6d27a; color:#8a5a00; }

    .file-box{
      margin-top: 8px;
      padding: 8px;
      border:1px dashed var(--border);
      border-radius: 10px;
      display:flex;
      flex-direction:column;
      gap:8px;
      background:#fff;
    }

    /* Tables */
    .table{
      width:100%;
      border-collapse: collapse;
      background:#fff;
      border:1px solid var(--border);
      border-radius: 12px;
      overflow:hidden;
    }
    .table th, .table td{
      text-align:left;
      padding:10px;
      border-bottom:1px solid var(--border);
      font-size: 13px;
      vertical-align: top;
    }
    .table th{ background:#fafafa; color: var(--muted); font-weight: 600; }
    .table tr:last-child td{ border-bottom:none; }

    .pill{
      font-size: 12px;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid var(--border);
      color: var(--muted);
      background:#fff;
    }

    .hidden{ display:none !important; }
  </style>
</head>

<body>
  <div class="shell">
    <div class="topbar">
      <div class="brand">
        <div class="title">Field Service</div>
      </div>
      <div class="row">
        <span class="muted" style="font-size:12px">Technician: T-0042</span>
      </div>
    </div>

    <div class="main">
      <aside class="sidebar">
        <div class="nav-title">Navigation</div>

        <div class="nav-section">
          <small>Logistics</small>

          <fluent-button class="nav-btn" id="navDeliveries" appearance="primary">
            Delivery Boxes
          </fluent-button>

          <fluent-button class="nav-btn" id="navInventory" appearance="subtle">
            Inventory
          </fluent-button>
        </div>
      </aside>

      <main class="content">
        <div class="card">
          <section id="pageDeliveries"></section>
          <section id="pageInventory" class="hidden"></section>
        </div>
      </main>
    </div>
  </div>

  <script>
    // ---------------------------------
    // Mock data (represents "SAP output")
    // ---------------------------------
    const MOCK = {
      boxes: [
        {
          boxId: "BX-102938",
          shipDate: "2025-12-28T10:30:00Z",
          items: [
            // WO-related
            { id:"i1",  partId:"P-100012", desc:"Thermostat assembly",        qty:1, woId:"WO-450012", status:"Pending", note:"", fileName:"" },
            { id:"i2",  partId:"P-100201", desc:"Water inlet valve",          qty:2, woId:"WO-450012", status:"Pending", note:"", fileName:"" },
            { id:"i3",  partId:"P-100880", desc:"Drain pump",                 qty:1, woId:"WO-450130", status:"Pending", note:"", fileName:"" },
            // Van Stock Reserved (WO-unassigned)
            { id:"i4",  partId:"P-100311", desc:"Door seal gasket",           qty:1, woId:null,        status:"Pending", note:"", fileName:"" },
            { id:"i5",  partId:"P-100777", desc:"Hose kit",                   qty:2, woId:null,        status:"Pending", note:"", fileName:"" }
          ]
        },
        {
          boxId: "BX-774401",
          shipDate: "2025-12-27T15:05:00Z",
          items: [
            // WO-related
            { id:"i6",  partId:"P-101010", desc:"Control board",              qty:1, woId:"WO-450099", status:"Pending", note:"", fileName:"" },
            { id:"i7",  partId:"P-100555", desc:"Temperature sensor",         qty:1, woId:"WO-450099", status:"Pending", note:"", fileName:"" },
            { id:"i8",  partId:"P-100420", desc:"Door lock",                  qty:1, woId:"WO-450208", status:"Pending", note:"", fileName:"" },
            // Van Stock Reserved
            { id:"i9",  partId:"P-100901", desc:"Filter cartridge",           qty:3, woId:null,        status:"Pending", note:"", fileName:"" }
          ]
        },
        {
          boxId: "BX-550019",
          shipDate: "2025-12-29T07:15:00Z",
          items: [
            // WO-related
            { id:"i10", partId:"P-100333", desc:"Inlet hose",                 qty:1, woId:"WO-450300", status:"Pending", note:"", fileName:"" },
            { id:"i11", partId:"P-100334", desc:"Outlet hose",                qty:1, woId:"WO-450300", status:"Pending", note:"", fileName:"" },
            { id:"i12", partId:"P-100120", desc:"Power cable",                qty:1, woId:"WO-450011", status:"Pending", note:"", fileName:"" },
            // Van Stock Reserved
            { id:"i13", partId:"P-100432", desc:"Screw set",                  qty:5, woId:null,        status:"Pending", note:"", fileName:"" }
          ]
        }
      ],

      // Inventory (SAP snapshot-like output)
      // Required min fields: Part ID, description, quantity, inventory status (+ optional expected delivery date)
      inventory: [
        { partId:"P-100012", desc:"Thermostat assembly",     qty: 1, status:"Available",  expectedDeliveryDate:null },
        { partId:"P-100201", desc:"Water inlet valve",       qty: 2, status:"Available",  expectedDeliveryDate:null },
        { partId:"P-100311", desc:"Door seal gasket",        qty: 1, status:"On Hand",    expectedDeliveryDate:null },
        { partId:"P-100777", desc:"Hose kit",                qty: 1, status:"On Hand",    expectedDeliveryDate:null },
        { partId:"P-101010", desc:"Control board",           qty: 1, status:"Allocated",  expectedDeliveryDate:null },
        { partId:"P-100420", desc:"Door lock",               qty: 1, status:"Allocated",  expectedDeliveryDate:null },
        { partId:"P-100999", desc:"Pressure switch",         qty: 0, status:"On Order",   expectedDeliveryDate:"2026-01-03" },
        { partId:"P-100901", desc:"Filter cartridge",        qty: 0, status:"On Order",   expectedDeliveryDate:"2026-01-02" },
      ]
    };

    // ---------------------------------
    // State
    // ---------------------------------
    const state = {
      route: "deliveries",   // deliveries | inventory
      boxIdInput: "",
      workingBox: null,      // deep copy of found box for editing
      message: null          // { type: "ok"|"err"|"warn", text: string }
    };

    // ---------------------------------
    // Utilities
    // ---------------------------------
    const $ = (sel) => document.querySelector(sel);
    const escapeHtml = (s) => (s ?? "").toString().replace(/[&<>"']/g, (m) =>
      ({ "&":"&amp;", "<":"&lt;", ">":"&gt;", '"':"&quot;", "'":"&#039;" }[m])
    );

    function formatDate(iso){
      try{
        const d = new Date(iso);
        return d.toLocaleString(undefined, { year:"numeric", month:"short", day:"2-digit", hour:"2-digit", minute:"2-digit" });
      }catch{ return iso; }
    }

    function itemBadge(status){
      if (status === "Received") return `<span class="status-badge recv">Received</span>`;
      if (status === "Missing")  return `<span class="status-badge miss">Missing</span>`;
      if (status === "Damaged")  return `<span class="status-badge dmg">Damaged</span>`;
      return `<span class="status-badge">Pending</span>`;
    }

    function setMessage(type, text){
      state.message = { type, text };
      render();
    }
    function clearMessage(){
      state.message = null;
      render();
    }
    function deepCopy(obj){
      return JSON.parse(JSON.stringify(obj));
    }

    function renderMessage(){
      if (!state.message) return "";
      const cls = state.message.type === "ok" ? "notice ok" : state.message.type === "warn" ? "notice warn" : "notice err";
      return `<div class="${cls}">
        <div class="row">
          <div><b>${escapeHtml(state.message.type.toUpperCase())}</b> — ${escapeHtml(state.message.text)}</div>
          <div class="space"></div>
          <fluent-button appearance="subtle" id="btnDismissMsg">Dismiss</fluent-button>
        </div>
      </div>`;
    }

    // ---------------------------------
    // Navigation
    // ---------------------------------
    function setRoute(route){
      state.route = route;
      if (route === "deliveries") {
        $("#navDeliveries").setAttribute("appearance","primary");
        $("#navInventory").setAttribute("appearance","subtle");
        $("#pageDeliveries").classList.remove("hidden");
        $("#pageInventory").classList.add("hidden");
      } else {
        $("#navDeliveries").setAttribute("appearance","subtle");
        $("#navInventory").setAttribute("appearance","primary");
        $("#pageDeliveries").classList.add("hidden");
        $("#pageInventory").classList.remove("hidden");
      }
      render();
    }

    // ---------------------------------
    // Delivery Boxes actions
    // ---------------------------------
    function findBoxById(boxId){
      clearMessage();
      const found = MOCK.boxes.find(b => b.boxId.toLowerCase() === (boxId||"").trim().toLowerCase());
      if (!found){
        state.workingBox = null;
        setMessage("err", "Box ID not found. Please check and try again.");
        return;
      }
      state.workingBox = deepCopy(found);
      setMessage("ok", `Box loaded: ${found.boxId}`);
    }

    function resetBox(){
      state.boxIdInput = "";
      state.workingBox = null;
      clearMessage();
    }

    function updateItem(itemId, patch){
      if (!state.workingBox) return;
      state.workingBox.items = state.workingBox.items.map(it => it.id === itemId ? { ...it, ...patch } : it);
      render();
    }

    function validateBoxBeforeSubmit(){
      if (!state.workingBox) return "No box selected.";
      const items = state.workingBox.items || [];
      const pending = items.filter(i => i.status === "Pending");
      if (pending.length) return "Please confirm all items (no Pending items allowed).";

      const damagedNoFile = items.filter(i => i.status === "Damaged" && !i.fileName);
      if (damagedNoFile.length) return "For Damaged items, file upload is required.";

      const damagedNoNote = items.filter(i => i.status === "Damaged" && !(i.note||"").trim());
      if (damagedNoNote.length) return "For Damaged items, a short note is required.";

      return null;
    }

    // Inventory update helper (demo behavior)
    // When WO-unassigned item is received, we move/add it to "On Hand"
    function upsertInventory(partId, desc, deltaQty, targetStatus){
      const row = MOCK.inventory.find(r => r.partId === partId && r.status === targetStatus);
      if (row){
        row.qty += deltaQty;
      } else {
        MOCK.inventory.push({ partId, desc, qty: deltaQty, status: targetStatus, expectedDeliveryDate: null });
      }
    }

    function submitBoxConfirmation(){
      clearMessage();
      const err = validateBoxBeforeSubmit();
      if (err){ setMessage("err", err); return; }

      // Persist into mock "DB"
      const idx = MOCK.boxes.findIndex(b => b.boxId === state.workingBox.boxId);
      if (idx >= 0) MOCK.boxes[idx] = deepCopy(state.workingBox);

      // Demo rule:
      // If item is Van Stock Reserved (WO-unassigned) and Received => add to Inventory as "On Hand"
      const reservedReceived = state.workingBox.items.filter(i => !i.woId && i.status === "Received");
      reservedReceived.forEach(i => upsertInventory(i.partId, i.desc, i.qty, "On Hand"));

      const items = state.workingBox.items;
      const received = items.filter(i => i.status === "Received").length;
      const missing = items.filter(i => i.status === "Missing").length;
      const damaged = items.filter(i => i.status === "Damaged").length;

      setMessage("ok", `Submitted. Received: ${received}, Missing: ${missing}, Damaged: ${damaged}.`);
    }

    function renderItemRow(item){
      const kindTag = item.woId
        ? `<span class="tag wo">WO-related • ${escapeHtml(item.woId)}</span>`
        : `<span class="tag vs">Van Stock Reserved • WO-unassigned</span>`;

      const fileBlock = (item.status === "Damaged") ? `
        <div class="file-box">
          <input type="file" data-file-for="${escapeHtml(item.id)}" />
          <fluent-text-area
            data-note-for="${escapeHtml(item.id)}"
            placeholder="Damage note (required)"
            value="${escapeHtml(item.note||"")}"
            resize="vertical"
            style="width:100%"
          ></fluent-text-area>
          <div class="muted" style="font-size:12px">
            Selected file: <b>${escapeHtml(item.fileName || "—")}</b>
          </div>
        </div>
      ` : "";

      return `
        <div class="item-row">
          <div class="item-meta">
            <div><b>${escapeHtml(item.partId)}</b> — ${escapeHtml(item.desc)}</div>
            <div class="row wrap" style="gap:8px">
              ${kindTag}
              ${itemBadge(item.status)}
            </div>
            ${fileBlock}
          </div>

          <div>
            <div class="muted" style="font-size:12px">Quantity</div>
            <div style="font-size:14px; font-weight:650">${escapeHtml(item.qty)}</div>
          </div>

          <div>
            <div class="muted" style="font-size:12px">Confirmation</div>
            <fluent-select data-status-for="${escapeHtml(item.id)}" style="width:100%">
              <fluent-option value="Pending"  ${item.status==="Pending" ?"selected":""}>Pending</fluent-option>
              <fluent-option value="Received" ${item.status==="Received"?"selected":""}>Received</fluent-option>
              <fluent-option value="Missing"  ${item.status==="Missing" ?"selected":""}>Missing</fluent-option>
              <fluent-option value="Damaged"  ${item.status==="Damaged" ?"selected":""}>Damaged</fluent-option>
            </fluent-select>
          </div>
        </div>
      `;
    }

    function renderDeliveriesPage(){
      const container = $("#pageDeliveries");
      const box = state.workingBox;

      let detailsHtml = `
        <div class="panel">
          <div class="muted">Enter a Box ID and click “Find box”.</div>
          ${renderMessage()}
        </div>
      `;

      if (box){
        const items = box.items || [];
        const woItems = items.filter(x => !!x.woId);
        const vsItems = items.filter(x => !x.woId);
        const done = items.filter(x => x.status !== "Pending").length;

        detailsHtml = `
          <div class="panel">
            <div class="row wrap">
              <div>
                <div class="h2">Box details</div>
                <div class="muted" style="font-size:12px">
                  Box ID: <b>${escapeHtml(box.boxId)}</b> • Ship: ${escapeHtml(formatDate(box.shipDate))} • Progress: ${done}/${items.length}
                </div>
              </div>
              <div class="space"></div>
              <span class="pill">Items: ${items.length}</span>
              <span class="pill">WO-related: ${woItems.length}</span>
              <span class="pill">Van Stock Reserved: ${vsItems.length}</span>
            </div>

            ${renderMessage()}

            <fluent-tabs activeid="woTab" id="boxTabs" style="margin-top:10px">
              <fluent-tab id="woTab">Work Order related (${woItems.length})</fluent-tab>
              <fluent-tab id="vsTab">Van Stock Reserved (${vsItems.length})</fluent-tab>

              <fluent-tab-panel id="woTabPanel">
                <div class="items">
                  ${woItems.length ? woItems.map(renderItemRow).join("") : `<div class="notice warn">No WO-related items in this box.</div>`}
                </div>
              </fluent-tab-panel>

              <fluent-tab-panel id="vsTabPanel">
                <div class="items">
                  ${vsItems.length ? vsItems.map(renderItemRow).join("") : `<div class="notice warn">No Van Stock Reserved items in this box.</div>`}
                </div>
              </fluent-tab-panel>
            </fluent-tabs>

            <div class="divider"></div>

            <div class="row wrap" style="justify-content:flex-end">
              <fluent-button appearance="subtle" id="btnResetBox">Reset</fluent-button>
              <fluent-button appearance="primary" id="btnSubmitBox">Submit confirmation</fluent-button>
            </div>
          </div>
        `;
      }

      container.innerHTML = `
        <div class="row wrap" style="margin-bottom:10px">
          <h1 class="h1">Delivery Boxes</h1>
          <div class="space"></div>
          <fluent-button appearance="subtle" id="btnClearMsg">Clear message</fluent-button>
        </div>

        <div class="grid-2">
          <div class="panel">
            <div class="h2">Find Delivery Box</div>

            <div class="row" style="margin-top:10px">
              <fluent-text-field
                id="boxIdInput"
                placeholder="e.g., BX-102938"
                value="${escapeHtml(state.boxIdInput)}"
                style="width:100%"
              ></fluent-text-field>
              <fluent-button appearance="primary" id="btnFindBox">Find box</fluent-button>
            </div>

            <div class="divider"></div>

            <div class="muted" style="font-size:12px; line-height:1.5">
              Example Box IDs: <b>BX-102938</b>, <b>BX-774401</b>, <b>BX-550019</b>
            </div>
          </div>

          ${detailsHtml}
        </div>
      `;

      // Events
      const input = $("#boxIdInput");
      input?.addEventListener("input", (e) => {
        state.boxIdInput = e.target.value || "";
      });

      $("#btnFindBox")?.addEventListener("click", () => findBoxById(state.boxIdInput));
      $("#btnClearMsg")?.addEventListener("click", clearMessage);
      $("#btnDismissMsg")?.addEventListener("click", clearMessage);
      $("#btnResetBox")?.addEventListener("click", resetBox);
      $("#btnSubmitBox")?.addEventListener("click", submitBoxConfirmation);

      // Item status changes
      container.querySelectorAll("[data-status-for]")?.forEach(sel => {
        sel.addEventListener("change", (e) => {
          const itemId = e.currentTarget.getAttribute("data-status-for");
          const value = e.currentTarget.value;
          if (value !== "Damaged") {
            updateItem(itemId, { status: value, fileName: "", note: "" });
          } else {
            updateItem(itemId, { status: value });
          }
        });
      });

      // File changes
      container.querySelectorAll("input[type='file'][data-file-for]")?.forEach(inp => {
        inp.addEventListener("change", (e) => {
          const itemId = e.currentTarget.getAttribute("data-file-for");
          const file = e.currentTarget.files && e.currentTarget.files[0];
          updateItem(itemId, { fileName: file ? file.name : "" });
        });
      });

      // Note changes
      container.querySelectorAll("[data-note-for]")?.forEach(ta => {
        ta.addEventListener("input", (e) => {
          const itemId = e.currentTarget.getAttribute("data-note-for");
          const value = e.currentTarget.value || "";
          updateItem(itemId, { note: value });
        });
      });
    }

    // ---------------------------------
    // Inventory rendering
    // ---------------------------------
    function renderInventoryTable(rows){
      const showExpected = rows.some(r => r.status === "On Order");
      return `
        <table class="table">
          <thead>
            <tr>
              <th style="width:180px">Part ID</th>
              <th>Part description</th>
              <th style="width:140px">Quantity</th>
              <th style="width:160px">Inventory status</th>
              ${showExpected ? `<th style="width:220px">Expected delivery date</th>` : ``}
            </tr>
          </thead>
          <tbody>
            ${rows.map(r => `
              <tr>
                <td><b>${escapeHtml(r.partId)}</b></td>
                <td>${escapeHtml(r.desc)}</td>
                <td>${escapeHtml(r.qty)}</td>
                <td>${escapeHtml(r.status)}</td>
                ${showExpected ? `<td class="muted">${escapeHtml(r.expectedDeliveryDate || "—")}</td>` : ``}
              </tr>
            `).join("") || `<tr><td colspan="${showExpected ? 5 : 4}" class="muted">No items.</td></tr>`}
          </tbody>
        </table>
      `;
    }

    function renderInventoryPage(){
      const container = $("#pageInventory");
      const all = MOCK.inventory;

      const available = all.filter(x => x.status === "Available");
      const onHand = all.filter(x => x.status === "On Hand");
      const allocated = all.filter(x => x.status === "Allocated");
      const onOrder = all.filter(x => x.status === "On Order");

      container.innerHTML = `
        <div class="row wrap" style="margin-bottom:10px">
          <h1 class="h1">Inventory</h1>
          <div class="space"></div>
          <span class="pill">Source: SAP</span>
          <span class="pill">Last refresh: ${escapeHtml(new Date().toLocaleString())}</span>
        </div>

        <div class="panel">
          <div class="h2">My Van Inventory</div>

          <div class="divider"></div>

          <fluent-tabs activeid="tabAvailable" id="invTabs">
            <fluent-tab id="tabAvailable">Available (${available.length})</fluent-tab>
            <fluent-tab id="tabOnHand">On Hand (${onHand.length})</fluent-tab>
            <fluent-tab id="tabAllocated">Allocated (${allocated.length})</fluent-tab>
            <fluent-tab id="tabOnOrder">On Order (${onOrder.length})</fluent-tab>

            <fluent-tab-panel id="panelAvailable">
              ${renderInventoryTable(available)}
            </fluent-tab-panel>

            <fluent-tab-panel id="panelOnHand">
              ${renderInventoryTable(onHand)}
            </fluent-tab-panel>

            <fluent-tab-panel id="panelAllocated">
              ${renderInventoryTable(allocated)}
            </fluent-tab-panel>

            <fluent-tab-panel id="panelOnOrder">
              ${renderInventoryTable(onOrder)}
            </fluent-tab-panel>
          </fluent-tabs>
        </div>
      `;
    }

    // ---------------------------------
    // Render switch
    // ---------------------------------
    function render(){
      if (state.route === "deliveries") renderDeliveriesPage();
      if (state.route === "inventory") renderInventoryPage();
    }

    // Init
    $("#navDeliveries").addEventListener("click", () => setRoute("deliveries"));
    $("#navInventory").addEventListener("click", () => setRoute("inventory"));
    render();
  </script>
</body>
</html>
